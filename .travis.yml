language: java
cache:
  directories:
  - "$HOME/.m2"
sudo: required
services:
- docker
notifications:
  email:
  - ci@estimator.cloud
  on_success: always
  on_failure: always
branches:
  only:
  - master
before_install:
- gem install travis -v 1.8.8 --no-rdoc --no-ri
- sudo curl -k -o /usr/local/bin/ecs-cli https://s3.amazonaws.com/amazon-ecs-cli/ecs-cli-linux-amd64-latest
- sudo chmod +x /usr/local/bin/ecs-cli
- export BUILD_NAME=discovery-server-$TRAVIS_BRANCH-$(date -u "+%Y%m%d%H%M%S")-$TRAVIS_BUILD_NUMBER
script:
- sh travis_scripts/tag_build.sh
- sh travis_scripts/build_services.sh
- sh travis_scripts/deploy_to_docker_hub.sh
- sh travis_scripts/deploy_to_amazon_ecs.sh
env:
  global:
  - secure: LkwSmltzEgaRICXgVJelfw4ITZrH0Hbjy76VaXRywXCXJOHn5+UMyxiRXCgjZ/bh3+11an1Uy4NJGZWRJ5P5aKsplB3alwoda1KA8mdWwxIE33b0SZFlXWu4pWRoxSn6PBx222+UBHg4UxarFkZ7LdI4AJVDPzvhO4XFWSFQomlAbcevgMiwk5qGciI970QYjQkPcIcO/k7Rt1gvQ9lXCLrBvtzyV3XexhdxOJZjZlVLpn8Qex1atMKI4ss+4wGR3QtVJx8aDpuLXOMWQtiEM9yioWMVPGGGKcXD7Z/B4PA8n9sN+s2jVpnepDMK094Uw4VIsPsYmyHQgH7jAonerYkvrIqAgYW/fDZKTLhUOWLNyqeeDCF5lMXtAFt4D10c0q6jVE3laCdG9F7iKyyv2tcR6AqJMuqvIRUuEIAfZe45Ms8WVZq585Hqg42/TJXnKg0U5MvQKzFnegUuT/RpdItRIfmeB3nssb2X22fmkvA9Y6e20IetlXybpgQjjURuVzpRit1ua1cs3ip2Pg+tU3tL22FF4d1xbu7ndV6Z9h6oUntv4NyAqHwXzSHMYrt4tbMNG1I2HPKWsL56WFJJrk15RvhGrHmk1ftUFC9FHkJnJs2GShyKvGJQVN163hn1qMcXihoUuSXMqlg/wj5qrh9V/kNM+g7YCGXP0unnuHo=
  - secure: K2lSxXFzTaoHJS1WTiyIsw+EIWgnnH4Q26ZBWH8H4Dk0stHKCoUi2ul0sBB4NgBB6z7Ex5/Exlh06xQmD+qlkM6hWGni1DljLx/qtHri4DnoAT+dLYWoudKMkrU0f4hmGDrysvj/M5jzyDzP/Q/l3fF7tftwzFoT1SwomNiYbiYVwJ79ufVEzHmTnf/g8kLe5q2Vu4oztZGRReqRgxlEP3An3bRJT3rDQyxIQaxa17oB4O0oQ50ovLnKch8noj4QRi6J9OFsTTNf+mGutbFR0OPO3FtwRlIY44gu9MnBlZXud01Qw8hlURpymtaQSrh2Hu2Vli7OvB1w4GCZkJLh/8suaHWZlCMjLIP/yhbNE7uOaj8uy5P1dr215ZVZXCcP7zk7HYPrMBGGF3U6KE0uwf7oObw8dsJ3cSxNpsmmwrHjEfWp4SaFXbmSk+O6gjVDwwA9xkQKotNSIElTOLZKpPkqPHEFbc626xSb5HzDbmZgZQON+V75zueUjvDTuF88jNP1FPMmmIIK0x5JI2KHm7VrB3GrJ4Mkg5ZbOyR/On690L6ydjIdEuDmKZwvmOheKtAnswK/GQ7xwr5WAxp3mIKugB/pA9e9VjXY/Ol6GTXwKe0C+wZ9NTBa5N4EBzFPXmsl7N+xdIFeJQ4cojooEoZwHTu7sbgBpsNjuE6gCEw=
  - secure: dt4Kfk4za3iMwJYAhvt0M4oYOwSRQNkOk5g7TdLYKQwMCa5g8WcphsozMeSIaGja11J8FqR+bM/EbRTSP4pdNhZ+GQ7VTpGjw1nvi3TflwW4uwaJw9io1EPd8QuGiKaA44A4enShYlImsUc+InvIqGCfgMOkEWbBKocFSfnmiLFtsX3OF1rs0r/itPM7ap1aKCyYRvUXJAnulIrrIlxw2jE9F0ATlOmk9nkhPr/hxhcY73cRDoedESjYiKeoewumWInrNLjQJJBNX9fOlQ7Zm+HPn32ydPZZQhcUtZZmXPyzAvwmFFZ2VFdv4JcBNwHthEXD3rpIbqOJpDAaBlp7wcOkUDmyXh9Zs1kYTmTt1d0sHFos44QvMAuB9AOZrg2MoXtP8L/oNAGYmaZ7HCbmJOpWzAQZc5H0btuav1Lu68DE9DAzKLjByuTbm4ElQEFqfj2UCOCYS9IZ5u8T/Swm8pDcNmZE1Wp6s33FxWAEYrbVsE/4YpKgLlxaVPbpS5KSuay0pssWs4iE93T95FFX/9X46hdEF2Nk1x2usUue5I29o6lE64NSlkhO8PNTXPEP9Z54SmKiCSQEF++1Nuyn3Pn1NwdODNmZdgnR2CWS+KAPrc/H7IEGU5PFFN+h2uYgETl/3QK0rowIq3G/dlYsWcbndiUU39CEtU2YJyTRX+M=
  - secure: DTFSuCIi3LQKa+8JiuTnKjgiH8HEkpc6fOXeXDhILtY4UrQ580dhP43eBu4GMnjbocskVa+zzopVgnW7o1nDOz37Pr1dPN5/ZNQ8rTF3rNB2cqvzePu02SRW3Nh7Qv3i+w6j2TFSEy+8wb39sanFCLGTZHfnONv2+40StGX24Z9pl6ZP1oCbtQRr0n/dzp87qif0dWpbwQBGz8fm+I7g9rv/n4eSXkNUf1ldUcuuibw1OjZkc/OS67ZDCCyCSjPzcFuOPkix9TRRs5H7xmilV1RXshd/voU3/yW5UFG+mKfo7kA9/wNR0G6mvcX0U9mfe2RD+Ka3pKb2OfXyAlu4KXVBJyTBM8d3ivztvHuHXADf/k2D+pGF90E7SpzbJXoCNE4v6XLJQ6QQvIK//VocLNzu9ATiwxKbd9ep9nTHb0cDvf/Wgj35HrgJ8w/uCbPpu3Wa0zsm4PqGdOQaVkpChwPwxyp9TtpF5+wRZqOf53Wn/mrmx7/98WIqlCugLe7ubC1RYEl1ykiE7aM3z1VpyeASMH9vx2TPWL5A+OKssSLNHx40JDOdkJSVO96rHD+Y2wZ/H9eX4UrOy/ivDoKwCxQi+d8xwSYsbRk7f2E6qeJwVipRmqELIX0meDqvyhI7KJjCpKYU2x3p1ZRAmpdxCeUFpwYcICbGR17i4nPzg6Q=
  - secure: QzfkywlgYLU/oF7sK1+MY9yy5gX0HNvsqLQNolAomRqpysk9PzHpD/3jO/wTG5bvS1Pt5z2A/x9llkRV2SmgabA0R/2JVsXVw3u9S3+U6ioh+EXLtZKLY7rpWIxlh/6+w1quZlq/FVAfxl+GQIZePGKWKUjf0vfx33qrC4vw10glydoaP0Jr3vwSfrpcTQ7yqB5I1T+ufzy2l2BBgZHlD7dFuD4nOhh2St42rM8zZpBagFEWyjtJu81HzZVipyibfJfuU9AJg1OaEuQoC+8o8tQ6n4b8hIGojC5KAa/4RX5n6wYjd4aTrmUOZYeafrSG+sfWqiUDt5QfAIJNtMbFEpDkQcQzG7mY8jusQEnOl6GxYkIUHvMJum824bwP+m+3NMnHTCEnJxD6I/8s91qMTfPHJpHSic1383R9NrCe2zeEiazj/GoXNwJYtW7/MVHNSZVQETFcQPrpOLxywxh5afbqmj74iTQ/HL5WBx4yOsNPnw2S89sD/yzoU2wEQRKVGK38nDW83gYCvLOsKmS4U0ravi5s2IHdVAKSxnIKHNUll33R0DGHBnsj++3YgyWi5L4f6Tspm84MG5jPZLmrpLvC2/FKUkGeJHshgx9KVixX2PNjOjgQC3lR7Fzrcti+J+HxEKStE1SJ5z87AlEk4jyuqGfcJLBIKA8lsZwphts=
